// This file is used to overwrite the way Sequelize loads it's configuration
// We run settings.yml through a templating engine and configure our database
// settings based on the environment. This allows us to still use that setup
// with sequelize migrations.
require('./config/nuts').configure();
var fs              = require('fs');
var path            = require('path')
var tmpDir          = "tmp"
var configFileName  = "sequelize-config.json";
var configPath      = path.join(tmpDir, configFileName);

// Create the tmp directory if it doesn't exist
try { fs.mkdirSync(tmpDir); } catch(e) { }

// Load the database configuration
config = {}
config[Nuts.environment] = Nuts.settings.database;

// Write it out to a tempfile for Sequelize to read
try { fs.writeFileSync(configPath, JSON.stringify(config)); } catch(e) { }

console.log(configPath);

module.exports = {
  'config': configPath,
  'migrations-path': path.resolve('migrations')
}
